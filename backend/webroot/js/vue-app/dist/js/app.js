(function(){"use strict";var e={8714:function(e,a,t){var n=t(9242),l=t(3396);function r(e,a,t,n,r,s){const o=(0,l.up)("TaskPage");return(0,l.wg)(),(0,l.j4)(o)}const s={class:"page-container"};function o(e,a,t,n,r,o){const i=(0,l.up)("TaskList"),d=(0,l.up)("TaskAdd"),c=(0,l.up)("TaskView"),u=(0,l.up)("ConfirmDialog");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l._)("div",s,[(0,l.Wm)(i,{parentId:null}),["add","edit"].includes(n.displayPanel)?((0,l.wg)(),(0,l.j4)(d,{key:0})):(0,l.kq)("",!0),"view"==n.displayPanel?((0,l.wg)(),(0,l.j4)(c,{key:1})):(0,l.kq)("",!0)]),(0,l.Wm)(u)],64)}const i=e=>((0,l.dD)("data-v-e057e068"),e=e(),(0,l.Cn)(),e),d={class:"task-card"},c={class:"filter-bar"},u=i((()=>(0,l._)("label",{for:"taskSearch"},"Search:",-1))),p=i((()=>(0,l._)("label",{for:"taskStatusFilter"},"âœ”:",-1))),m=i((()=>(0,l._)("option",{value:null},"All",-1))),v=i((()=>(0,l._)("option",{value:!0},"Completed",-1))),k=i((()=>(0,l._)("option",{value:!1},"Uncompleted",-1))),g=[m,v,k],f=i((()=>(0,l._)("i",{class:"filter-icon"},"ðŸ”",-1))),w=[f],y=i((()=>(0,l._)("i",{class:"filter-icon"},"+ðŸ“‹",-1))),h=[y],_=["disabled"];function b(e,a,t,r,s,o){const i=(0,l.up)("TaskItem");return(0,l.wg)(),(0,l.iD)("div",d,[(0,l._)("div",c,[u,(0,l.wy)((0,l._)("input",{id:"taskSearch","onUpdate:modelValue":a[0]||(a[0]=e=>r.search=e),placeholder:"Search tasks...","aria-label":"Search tasks"},null,512),[[n.nr,r.search,void 0,{trim:!0}]]),p,(0,l.wy)((0,l._)("select",{"onUpdate:modelValue":a[1]||(a[1]=e=>r.completion=e),id:"taskStatusFilter","aria-label":"Filter tasks by status"},g,512),[[n.bM,r.completion]]),(0,l._)("button",{onClick:a[2]||(a[2]=(...e)=>r.applyFilter&&r.applyFilter(...e)),"aria-label":"Apply filter"},w),(0,l._)("button",{onClick:a[3]||(a[3]=e=>r.displayAddTask(t.parentId)),"aria-label":"Add a root task"},h),(0,l._)("button",{onClick:a[4]||(a[4]=e=>r.displayDeleteConfirm()),disabled:!r.anyTaskSelected,"aria-label":"Remove selected tasks"}," ðŸ—‘ ",8,_)]),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(r.taskTree,(e=>((0,l.wg)(),(0,l.j4)(i,{key:e.id,task:e},null,8,["task"])))),128))])}var I=t(4870),T=t(7139);const C={class:"task-container"},E={class:"task-row mb-2"},D={class:"task-col-1"},S=["checked"],U={class:"task-col-3 task-actions"},O={key:0,class:"margin"};function V(e,a,t,n,r,s){const o=(0,l.up)("Spinner"),i=(0,l.up)("SwitchControl"),d=(0,l.up)("TaskItem",!0);return(0,l.wg)(),(0,l.iD)("div",C,[(0,l._)("div",E,[(0,l._)("div",D,[(0,l._)("input",{type:"checkbox",checked:t.task.selected,onChange:a[0]||(a[0]=e=>n.toggleTaskSelected(t.task.id,e.target.checked))},null,40,S)]),(0,l._)("div",{class:"task-col-8",onClick:a[1]||(a[1]=e=>n.displayViewTask(t.task.id))},(0,T.zw)(t.task.name),1),(0,l.Wm)(o,{loading:n.loading},null,8,["loading"]),(0,l._)("div",U,[(0,l._)("button",{class:"icon-btn",onClick:a[2]||(a[2]=e=>n.displayDeleteConfirm(t.task.id))},"ðŸ—‘"),(0,l._)("button",{class:"icon-btn",onClick:a[3]||(a[3]=e=>n.displayAddTask(t.task.id))},"â¨¢ðŸ“‹"),(0,l._)("button",{class:"icon-btn",onClick:a[4]||(a[4]=e=>n.displayEditTask(t.task.id))},"âœŽ"),(0,l.Wm)(i,{value:t.task.completed,onClick:a[5]||(a[5]=e=>t.task.completed?n.setNotCompleted:n.setCompleted),stringOn:"Completed",stringOff:"To do"},null,8,["value"]),(0,l._)("button",{class:"icon-btn",onClick:a[6]||(a[6]=e=>n.toggleTaskFold(t.task.id))},(0,T.zw)(t.task.folded?"â·":"â¶"),1)])]),t.task.folded?(0,l.kq)("",!0):((0,l.wg)(),(0,l.iD)("div",O,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(t.task.children,(e=>((0,l.wg)(),(0,l.j4)(d,{key:e.id,task:e},null,8,["task"])))),128))]))])}const A=["title"];function F(e,a,t,r,s,o){return(0,l.wg)(),(0,l.iD)("div",{class:"switch-container",title:s.isOn?t.stringOn:t.stringOff},[(0,l.wy)((0,l._)("input",{type:"checkbox","onUpdate:modelValue":a[0]||(a[0]=e=>s.isOn=e),class:"switch",id:"switch",onChange:a[1]||(a[1]=(...e)=>o.toggleSwitch&&o.toggleSwitch(...e))},null,544),[[n.e8,s.isOn]]),(0,l._)("label",{class:(0,T.C_)({"switch-on":s.isOn}),for:"switch"},null,2)],8,A)}var P={name:"SwitchControl",props:{stringOn:{type:String,default:"On"},stringOff:{type:String,default:"Off"},value:{type:Boolean,default:!1}},data(){return{isOn:this.value}},methods:{toggleSwitch(){this.$emit("input",this.isOn)}}},H=t(89);const q=(0,H.Z)(P,[["render",F],["__scopeId","data-v-27098925"]]);var Z=q;const $={key:0,class:"spinner"};function j(e,a,t,n,r,s){return t.loading?((0,l.wg)(),(0,l.iD)("div",$)):(0,l.kq)("",!0)}var N={name:"RotationSpinner",props:{loading:{type:Boolean,default:!0}}};const z=(0,H.Z)(N,[["render",j],["__scopeId","data-v-0178a1e5"]]);var R=z,Y={name:"TaskItem",components:{SwitchControl:Z,Spinner:R},props:{task:{type:Object,required:!0}},setup(e){const{loading:a,toggleTaskSelected:t,displayAddTask:n,displayEditTask:r,displayViewTask:s,toggleTaskFold:o,displayDeleteConfirm:i,displayCompletedConfirm:d,setSubtasksSelected:c,updateTask:u}=(0,l.f3)("tasks"),p=()=>{d(e.task.id)},m=()=>{u({...e.task,completed:!0})};return(0,l.Ah)((()=>{c(e.task.id,!1),t(e.task.id,!1),o(e.task.id,!1)})),{toggleTaskSelected:t,displayAddTask:n,displayEditTask:r,displayViewTask:s,toggleTaskFold:o,displayDeleteConfirm:i,displayCompletedConfirm:d,loading:a,setCompleted:p,setNotCompleted:m}}};const L=(0,H.Z)(Y,[["render",V],["__scopeId","data-v-8ec2872c"]]);var x=L,B={props:{parentId:{type:Number,default:null}},components:{TaskItem:x},setup(e){const{tasks:a,loading:t,displayAddTask:n,fetchTasks:r,displayDeleteConfirm:s,displayCompletedConfirm:o}=(0,l.f3)("tasks"),i=(0,I.iH)(""),d="",c=(0,I.iH)(null),u=null,p=(0,I.iH)(1);(0,l.bv)((()=>{r({search:i.value,parentId:e.parentId,page:p.value,...null!==c.value?{completed:c.value}:{}})}));const m=(0,l.Fl)((()=>{const t=e=>a.value.filter((a=>a.parent_id===e)).map((e=>{const a=t(e.id);return a.length?{...e,children:a}:e}));return t(e.parentId)})),v=(0,l.Fl)((()=>a.value.some((e=>e.selected)))),k=()=>{if(e.parentId)return null;r({search:i,parentId:null,...null!==c.value?{completed:c.value}:{},page:i.value!==d||c.value!==u?1:p.value})};return{search:i,completion:c,loading:t,taskTree:m,tasks:a,anyTaskSelected:v,applyFilter:k,displayAddTask:n,displayDeleteConfirm:s,displayCompletedConfirm:o}}};const W=(0,H.Z)(B,[["render",b],["__scopeId","data-v-e057e068"]]);var M=W;const J=e=>((0,l.dD)("data-v-078770a6"),e=e(),(0,l.Cn)(),e),K={key:0,class:"task-card"},X={class:"task-card-title"},G={key:0},Q={key:1},ee={class:"task-card-content"},ae={class:"input-group"},te=J((()=>(0,l._)("label",{for:"task-name"},"Name",-1))),ne={key:0,class:"error-message"},le={class:"input-group"},re={class:"input-group"},se=J((()=>(0,l._)("label",{for:"task-image"},"Image",-1))),oe={key:0,class:"error-message"},ie={class:"input-group"},de=J((()=>(0,l._)("label",null,"Video URL",-1))),ce={key:0,class:"error-message"},ue=["disabled"],pe={key:0},me={key:1};function ve(e,a,t,r,s,o){const i=(0,l.up)("ImageUpload"),d=(0,l.up)("VideoInput"),c=(0,l.up)("Spinner");return r.currentTask?((0,l.wg)(),(0,l.iD)("div",K,[(0,l._)("div",X,[null===r.currentTask.parent_id?((0,l.wg)(),(0,l.iD)("span",G,"New root task")):r.currentTask?((0,l.wg)(),(0,l.iD)("span",Q,"New subtask of "+(0,T.zw)(r.parentName),1)):(0,l.kq)("",!0)]),(0,l._)("div",ee,[(0,l._)("div",ae,[te,(0,l.wy)((0,l._)("input",{id:"task-name","onUpdate:modelValue":a[0]||(a[0]=e=>r.currentTask.name=e),type:"text",class:(0,T.C_)({"is-invalid":r.nameError})},null,2),[[n.nr,r.currentTask.name]]),r.nameError?((0,l.wg)(),(0,l.iD)("div",ne,(0,T.zw)(r.nameError),1)):(0,l.kq)("",!0)]),(0,l._)("div",le,[(0,l._)("label",null,[(0,l.wy)((0,l._)("input",{type:"checkbox","onUpdate:modelValue":a[1]||(a[1]=e=>r.currentTask.completed=e)},null,512),[[n.e8,r.currentTask.completed]]),(0,l.Uk)(" Completed ")])]),(0,l._)("div",re,[se,(0,l.Wm)(i,{image:r.currentTask.image_path,onRemoveImage:r.handleRemoveImage,onNewImage:r.handleNewImage,onError:r.handleImageError},null,8,["image","onRemoveImage","onNewImage","onError"]),r.imageError?((0,l.wg)(),(0,l.iD)("div",oe,(0,T.zw)(r.imageError),1)):(0,l.kq)("",!0)]),(0,l._)("div",ie,[de,(0,l.Wm)(d,{onVideo_link:r.handleVideoUrl,onError:r.handleVideoError},null,8,["onVideo_link","onError"]),r.videoUrlError?((0,l.wg)(),(0,l.iD)("div",ce,(0,T.zw)(r.videoUrlError),1)):(0,l.kq)("",!0)]),(0,l._)("button",{disabled:!r.isValid||r.loading.value,onClick:a[2]||(a[2]=(...e)=>r.submitForm&&r.submitForm(...e))},[r.loading.value?((0,l.wg)(),(0,l.iD)("span",pe,"ðŸ”„")):(0,l.kq)("",!0),(0,l.Uk)(" Submit ")],8,ue),(0,l._)("button",{onClick:a[3]||(a[3]=(...e)=>r.setPanelOff&&r.setPanelOff(...e))},"Close")])])):((0,l.wg)(),(0,l.iD)("div",me,[(0,l.Wm)(c,{loading:r.loading},null,8,["loading"])]))}const ke=["src"],ge=["src"],fe={class:"controls"},we={key:0},ye={key:1};function he(e,a,t,r,s,o){return(0,l.wg)(),(0,l.iD)("div",null,[(0,l._)("div",{class:"image-preview",onClick:a[0]||(a[0]=(...e)=>o.selectImage&&o.selectImage(...e))},[s.selectedImage?((0,l.wg)(),(0,l.iD)("img",{key:0,src:s.selectedImage,class:"image-element",alt:"Selected Image"},null,8,ke)):t.image?((0,l.wg)(),(0,l.iD)("img",{key:1,src:t.image,class:"image-element",alt:"Uploaded Image"},null,8,ge)):((0,l.wg)(),(0,l.iD)(l.HY,{key:2},[(0,l.Uk)(" No Image ")],64))]),(0,l._)("div",fe,[t.image?((0,l.wg)(),(0,l.iD)("div",we,[(0,l.wy)((0,l._)("input",{type:"checkbox","onUpdate:modelValue":a[1]||(a[1]=e=>s.removeImage=e)},null,512),[[n.e8,s.removeImage]]),(0,l.Uk)(" Delete ")])):(0,l.kq)("",!0),o.selectImage?((0,l.wg)(),(0,l.iD)("div",ye,[s.selectedImage?((0,l.wg)(),(0,l.iD)("button",{key:0,onClick:a[2]||(a[2]=(...e)=>o.cancelImage&&o.cancelImage(...e))},"âŽŒ")):(0,l.kq)("",!0)])):(0,l.kq)("",!0)]),(0,l._)("input",{type:"file",ref:"fileInput",onChange:a[3]||(a[3]=(...e)=>o.handleImageChange&&o.handleImageChange(...e)),style:{display:"none"}},null,544)])}t(6229),t(7330),t(2062);var _e={props:{image:{type:String,default:""}},data(){return{removeImage:!1,selectedImage:null}},methods:{selectImage(){this.$refs.fileInput.click()},handleImageChange(e){const a=e.target.files[0];a?(this.selectedImage=URL.createObjectURL(a),this.$emit("newImage",a)):this.$emit("error","Failed to load the image.")},cancelImage(){this.selectedImage=null}},watch:{removeImage(e){this.$emit("removeImage",e)}}};const be=(0,H.Z)(_e,[["render",he],["__scopeId","data-v-7ff78adb"]]);var Ie=be;function Te(e,a,t,r,s,o){const i=(0,l.up)("LiteYouTubeEmbed");return(0,l.wg)(),(0,l.iD)("div",null,[(0,l.wy)((0,l._)("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>r.inputUrl=e),placeholder:"Paste or write a YouTube URL here",onInput:a[1]||(a[1]=(...e)=>r.validateUrl&&r.validateUrl(...e)),class:"input"},null,544),[[n.nr,r.inputUrl]]),r.isValid?((0,l.wg)(),(0,l.j4)(i,{key:0,id:r.videoId},null,8,["id"])):(0,l.kq)("",!0)])}var Ce=t(5917),Ee={name:"VideoInput",components:{LiteYouTubeEmbed:Ce.Z},props:{video_link:{type:String,default:""}},emits:["video_link","error"],setup(e,{emit:a}){const t=(0,I.iH)(e.video_link),n=(0,I.iH)(!1),r=(0,I.iH)(""),s=(0,I.iH)(""),o=()=>{const e=/^(https?:\/\/)?(www\.)?(youtube\.com|youtu\.?be)\/.+$/;if(e.test(t.value)){const e=/(?:v=|\/)([0-9A-Za-z_-]{10,12})/,l=!t.value||t.value.match(e);l?(r.value=l[1],n.value=!0,s.value="",a("video_link",t.value),a("error","")):(n.value=!1,s.value="Invalid YouTube video URL",a("error",s.value))}else n.value=!1,s.value="Invalid URL",a("error",s.value)};return(0,l.YP)((()=>e.video_link),(e=>{t.value=e,o()})),{inputUrl:t,isValid:n,videoId:r,errorMessage:s,validateUrl:o}}};const De=(0,H.Z)(Ee,[["render",Te],["__scopeId","data-v-c846a83c"]]);var Se=De,Ue={name:"AddTaskForm",components:{ImageUpload:Ie,VideoInput:Se,Spinner:R},setup(){const{tasks:e,loading:a,setPanelOff:t,displayViewTask:n,addTask:r,currentTask:s}=(0,l.f3)("tasks"),o=(0,I.iH)(""),i=(0,I.iH)(""),d=(0,I.iH)("");function c(){return s.value.name?s.value.name.length<3||s.value.name.length>255?(o.value="Name must be between 3 and 255 characters",!1):(o.value="",!0):(o.value="Name is required",!1)}function u(){return s.newImage&&s.newImage.size>=2e6?(i.value="Image size should be less than 2 MB",!1):(i.value="",!0)}function p(){return s.video_link&&!/^(https:\/\/)?(www\.youtube\.com|youtu\.?be)\/.+$/g.test(s.video_link)?(d.value="Invalid YouTube URL",!1):(d.value="",!0)}const m=(0,l.Fl)((()=>c()&&u()&&p())),v=(0,l.Fl)((()=>{const a=e.value.find((e=>e.id===s.value.parent_id));return a?a.name:""}));function k(e){s.value.removeImage=e}function g(e){s.value.newImage=e}function f(e){i.value=e}function w(e){s.value.video_link=e}function y(e){d.value=e}async function h(){const e=await r(s.value);e&&n(e)}return{nameError:o,imageError:i,videoUrlError:d,currentTask:s,handleVideoUrl:w,handleVideoError:y,isValid:m,parentName:v,loading:a,setPanelOff:t,submitForm:h,handleRemoveImage:k,handleNewImage:g,handleImageError:f}}};const Oe=(0,H.Z)(Ue,[["render",ve],["__scopeId","data-v-078770a6"]]);var Ve=Oe;const Ae=e=>((0,l.dD)("data-v-4758d650"),e=e(),(0,l.Cn)(),e),Fe={key:0,class:"task-card"},Pe={class:"task-card-header"},He={class:"task-card-title"},qe={class:"task-card-content"},Ze={class:"input-group"},$e={class:"image-preview"},je=["src"],Ne={class:"input-group"},ze=Ae((()=>(0,l._)("label",null,"Video URL",-1))),Re={key:0},Ye={key:1},Le={key:2,class:"error-message"},xe={key:1};function Be(e,a,t,n,r,s){const o=(0,l.up)("LiteYouTubeEmbed"),i=(0,l.up)("Spinner");return n.currentTask?((0,l.wg)(),(0,l.iD)("div",Fe,[(0,l._)("div",Pe,[(0,l._)("div",He,(0,T.zw)(n.currentTask.name),1),(0,l._)("button",{class:"closing",onClick:a[0]||(a[0]=e=>n.setPanelOff())}," X ")]),(0,l._)("div",qe,[(0,l._)("div",Ze,[(0,l._)("label",null,(0,T.zw)(n.currentTask.completed?"Completed":"TO DO"),1)]),(0,l._)("div",$e,[n.currentTask.image_path?((0,l.wg)(),(0,l.iD)("img",{key:0,src:n.currentTask.image_path,class:"image-element",alt:"Uploaded Image"},null,8,je)):((0,l.wg)(),(0,l.iD)(l.HY,{key:1},[(0,l.Uk)(" No Image ")],64))]),(0,l._)("div",Ne,[ze,n.currentTask.video_link?((0,l.wg)(),(0,l.iD)("div",Re,[(0,l._)("div",null,(0,T.zw)(n.currentTask.video_link),1),(0,l.Wm)(o,{id:n.videoId},null,8,["id"])])):((0,l.wg)(),(0,l.iD)("div",Ye," No video ")),e.videoUrlError?((0,l.wg)(),(0,l.iD)("div",Le,(0,T.zw)(e.videoUrlError),1)):(0,l.kq)("",!0)])])])):((0,l.wg)(),(0,l.iD)("div",xe,[(0,l.Wm)(i,{loading:n.loading},null,8,["loading"])]))}var We={name:"AddTaskForm",components:{Spinner:R,LiteYouTubeEmbed:Ce.Z},setup(){const{loading:e,setPanelOff:a,currentTask:t}=(0,l.f3)("tasks"),n=(0,l.Fl)((()=>{if(!t.value.video_link)return"";const e=/(?:v=|\/)([0-9A-Za-z_-]{10,12})/,a=t.value.video_link.match(e);return a&&a[1]?a[1]:""}));return{loading:e,setPanelOff:a,currentTask:t,videoId:n}}};const Me=(0,H.Z)(We,[["render",Be],["__scopeId","data-v-4758d650"]]);var Je=Me;const Ke={key:0,class:"dialog"},Xe={class:"card"},Ge={class:"card-title"},Qe={class:"card-actions"};function ea(e,a,t,n,r,s){return n.confirmStatus==n.confirmStatuses.asking?((0,l.wg)(),(0,l.iD)("div",Ke,[(0,l._)("div",Xe,[(0,l._)("h2",Ge,(0,T.zw)(n.question[0]),1),(0,l._)("ul",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(n.question.slice(1),((e,a)=>((0,l.wg)(),(0,l.iD)("li",{class:"card-li",key:a},(0,T.zw)(e),1)))),128))]),(0,l._)("div",Qe,[(0,l._)("button",{class:"btn btn-green",onClick:a[0]||(a[0]=e=>n.accept())},"Yes"),(0,l._)("button",{class:"btn btn-red",onClick:a[1]||(a[1]=e=>n.cancel())},"Cancel")])])])):(0,l.kq)("",!0)}const aa={none:"none",asking:"asking",confirmed:"confirmed",canceled:"canceled"};function ta(){const e=(0,I.iH)(aa.none),a=(0,I.iH)([]),t=(0,I.iH)(!1),n=()=>new Promise((a=>{const t=(0,l.YP)(e,((e,n)=>{if(n!==aa.asking)return t(),a(!1),!1;e!==aa.confirmed&&e!==aa.cancel||(t(),a(e===aa.confirmed))}))})),r=async(l,r)=>{e.value=aa.asking,a.value=l,await n(),e.value===aa.confirmed&&(t.value=await r()),e.value=aa.none};return(0,l.JJ)("confirm",{confirmStatus:e,question:a,success:t,displayConfirmation:r}),{displayConfirmation:r}}var na={name:"ConfirmDialog",setup(){const{confirmStatus:e,question:a}=(0,l.f3)("confirm");function t(){e.value=aa.confirmed}function n(){e.value=aa.canceled,setTimeout((()=>{e.value=aa.none}),1e3)}return{question:a,confirmStatus:e,confirmStatuses:aa,accept:t,cancel:n}}};const la=(0,H.Z)(na,[["render",ea]]);var ra=la,sa={components:{TaskList:M,TaskAdd:Ve,ConfirmDialog:ra,TaskView:Je},setup(){const{displayPanel:e}=(0,l.f3)("tasks");return{displayPanel:e}}};const oa=(0,H.Z)(sa,[["render",o],["__scopeId","data-v-3b456e1c"]]);var ia=oa,da=(t(7658),t(4161));const ca={NODE_ENV:"production",BASE_URL:"/js/vue-app/dist/"}.VUE_APP_API_BASE_URL||"http://localhost:8765",ua=`${ca}/api/tasks`;function pa(e,a){let t=[];for(const n of a)n.parentId===e&&(t.push(n.id),t=t.concat(pa(n.id,a)));return t}function ma(e){return{parent_id:e,name:"",image_path:"",video_link:"",completed:!1,newImage:null,removeImage:!1,selected:!1,folded:!0,children:[]}}function va(e,a){const t=(0,I.iH)([]),n=(0,I.iH)(ma(null)),r=(0,I.iH)(!1),s=(0,I.iH)(""),o=e=>{let a=[...t.value];e.forEach((e=>{const t=a.find((({id:a})=>a===e.id));t?Object.assign(t,e):a.push(e)})),t.value=a},i=(e,a)=>{const n=pa(e,t.value);n.length&&(t.value=t.value.map((e=>({...e,selected:n.includes(e.id)?a:e.selected}))))},d=(e,a)=>{t.value=t.value.map((t=>({...t,selected:t.id===e?a:t.selected}))),a&&i(e,a)},c=()=>t.value.filter((({selected:e})=>e)).map((({id:e})=>e)),u=e=>{n.value=e,s.value="view"},p=e=>{n.value=ma(e),s.value="add"},m=e=>{n.value=e,s.value="edit"},v=()=>{s.value=""},k=async a=>{r.value=!0;let t=null;try{s.value="view";const e=await da.Z.get(`${ua}/${a}.json`);if(e.error)throw new Error(e.error);if(!e.data?.task)throw new Error("Bad response form");o([e.data.task]),t=e.data.task}catch(n){e(n,"Failed to fetch more tasks.")}finally{r.value=!1}return t},g=async a=>{r.value=!0;let n=!1;const{parentId:l=0,page:s=1,search:i=""}=a;try{const e=await da.Z.get(`${ua}.json`,{params:{parentId:l,page:s,search:i,...void 0!==a.completed?{completed:a.completed}:{}}});if(e.error)throw new Error(e.error);if(!Array.isArray(e.data?.tasks))throw new Error("Bad data format");l||1!==s?o(e.data.tasks):t.value=e.data.tasks,n=!0}catch(d){e(d,"Failed to fetch more tasks.")}finally{r.value=!1}return n},f=async e=>{const a=t.value.find((a=>a.id!==e));if(a.folded)return o([{...a,folded:!a.folded}]),!0;const n=await g({parentId:e});return!!n&&(o([{...a,folded:!a.folded}]),!0)},w=async a=>{r.value=!1;let n=null;try{const e=new FormData;for(const t in a){const n=(()=>"boolean"===typeof a[t]?a[t]?1:0:a[t])();e.append(t,n)}const l=await da.Z.post(`${ua}.json`,e,{headers:{"Content-Type":"multipart/form-data"}});if(l.error)throw new Error(l.error);if(!l.data?.task)throw new Error("Bad response form");t.value.push(l.data.task),n=l.data.task.id}catch(l){e(l,"Error adding task.")}finally{r.value=!1}return n},y=async a=>{r.value=!1;let t=!1;try{const e=new FormData;for(const n in a)e.append(n,a[n]);const t=await da.Z.put(`${ua}/${a.id}`,e);if(t.error)throw new Error(t.error);o([a])}catch(n){e(n,"Error adding task.")}finally{r.value=!1}return t},h=async a=>{r.value=!1;let n=!1;try{const e=await da.Z.patch(`${ua}/1.json`,{action:"delete",tasksIds:a});if(e.error)throw new Error(e.error);t.value=t.value.filter((({id:e})=>!a.includes(e)))}catch(l){e(l,"Error adding task.")}finally{r.value=!1}return n},_=async a=>{r.value=!1;let n=!1;try{const e=await da.Z.patch(`${ua}`,{action:"complete",tasksIds:a});if(e.error)throw new Error(e.error);t.value=t.value.map((e=>a.includes(e.id)?{...e,completed:!0}:e))}catch(l){e(l,"Error completing tasks.")}finally{r.value=!1}return n},b=async e=>{const a=await k(e);a&&u(a)},T=async e=>{const a=await k(e);a&&m(a)},C=async e=>{p(e)},E=async e=>{const n=e?[...pa(e,t.value),e]:c(),l=["Are you sure you want to delete the following tasks?",...t.value.filter((({id:e})=>n.includes(e))).map((({name:e})=>e))],r=await a(l,(()=>h(n)));return r},D=async e=>{const n=e?[...pa(e,t.value),e]:c(),l=["Are you sure to mark the following tasks as completed?",...t.value.filter((({id:e})=>n.includes(e))).map((({name:e})=>e))],r=await a(l,(()=>_(n)));return r};(0,l.JJ)("tasks",{tasks:t,currentTask:n,displayPanel:s,loading:r,setSubtasksSelected:i,toggleTaskSelected:d,setPanelOff:v,displayAddTask:C,displayEditTask:T,displayViewTask:b,fetchTasks:g,addTask:w,updateTask:y,displayDeleteConfirm:E,displayCompletedConfirm:D,toggleTaskFold:f})}function ka(){const e=(0,I.iH)(null),a=(0,I.iH)(null),t=({uiMessage:t,logMessage:n})=>{e.value=t,a.value=n,console.error(n)};function n(e,a=""){let n,l;const r=e.response&&e.response.data&&e.response.data.message;if(r){const t={400:`Bad request. Please check your input. ${a}`,401:`Unauthorized. Please log in again. ${a}`,403:`Forbidden. You do not have the necessary permissions. ${a}`,404:`Resource not found. ${a}`,500:`Internal server error. Please try again later. ${a}`};n=t[e.response?.status]||r||"An unexpected error occurred.",l=r||"An unexpected error occurred. From server"}else n=e.uimessage||e.message||"An unexpected error occurred.",l=e.logmessage||e.message||"An unexpected error occurred.";t({uiMessage:n,logMessage:l})}return(0,l.JJ)("errors",{uiError:e,logError:a,handleError:n}),{handleError:n}}var ga={name:"App",components:{TaskPage:ia},setup(){const{handleError:e}=ka(),{displayConfirmation:a}=ta();va(e,a)}};const fa=(0,H.Z)(ga,[["render",r]]);var wa=fa;const ya=(0,n.ri)(wa);ya.mount("#app")}},a={};function t(n){var l=a[n];if(void 0!==l)return l.exports;var r=a[n]={exports:{}};return e[n].call(r.exports,r,r.exports,t),r.exports}t.m=e,function(){var e=[];t.O=function(a,n,l,r){if(!n){var s=1/0;for(c=0;c<e.length;c++){n=e[c][0],l=e[c][1],r=e[c][2];for(var o=!0,i=0;i<n.length;i++)(!1&r||s>=r)&&Object.keys(t.O).every((function(e){return t.O[e](n[i])}))?n.splice(i--,1):(o=!1,r<s&&(s=r));if(o){e.splice(c--,1);var d=l();void 0!==d&&(a=d)}}return a}r=r||0;for(var c=e.length;c>0&&e[c-1][2]>r;c--)e[c]=e[c-1];e[c]=[n,l,r]}}(),function(){t.n=function(e){var a=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(a,{a:a}),a}}(),function(){t.d=function(e,a){for(var n in a)t.o(a,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:a[n]})}}(),function(){t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){t.o=function(e,a){return Object.prototype.hasOwnProperty.call(e,a)}}(),function(){var e={143:0};t.O.j=function(a){return 0===e[a]};var a=function(a,n){var l,r,s=n[0],o=n[1],i=n[2],d=0;if(s.some((function(a){return 0!==e[a]}))){for(l in o)t.o(o,l)&&(t.m[l]=o[l]);if(i)var c=i(t)}for(a&&a(n);d<s.length;d++)r=s[d],t.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return t.O(c)},n=self["webpackChunkvue_app"]=self["webpackChunkvue_app"]||[];n.forEach(a.bind(null,0)),n.push=a.bind(null,n.push.bind(n))}();var n=t.O(void 0,[998],(function(){return t(8714)}));n=t.O(n)})();
//# sourceMappingURL=app.js.map